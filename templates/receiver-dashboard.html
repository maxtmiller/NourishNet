{% extends "layout.html" %}

{% block title %}
    Food Bank Home
{% endblock %}

{% block main %}
    <div id="mainBody">
        <header>
            <h1>NourishNet</h1>
            <h2>Welcome to your food bank dashboard. Select an option below to manage your operations.</h2>
        </header> 

        <!-- Manage Applications Section -->
        <section class="section manage-applications">
            <h3>Manage Business Applications</h3>
            <p>Review and manage applications from potential members of your business.</p>
            {% if applications %}
                <div class="applications">
                    <table class="table">
                        <thead>
                            <tr>
                                <th>Name</th>
                                <th>Email</th>
                                <th>Status</th>
                                <th>Action</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for application in applications %}
                                <tr>
                                    <td>{{ application.name }}</td>
                                    <td>{{ application.email }}</td>
                                    <td>Awaiting Decision</td>
                                    <td>
                                        <a href="/manage-applications/accept/{{ application.id }}" class="btn btn-success">Approve</a>
                                        <a href="/manage-applications/reject/{{ application.id }}" class="btn btn-danger">Reject</a>
                                    </td>
                                </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            {% else %}
                <p>No applicants found.</p>
            {% endif %}
        </section>

        <!-- Edit Members Section -->
        <section class="section edit-members">
            <h3>Edit Current Affiliated Members</h3>
            <p>Manage the details of your current business members. You can update their roles or remove them from the business.</p>
            <div class="members">
                <table class="table">
                    <thead>
                        <tr>
                            <th>Name</th>
                            <th>Email</th>
                            <th>Action</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for member in members %}
                            <tr>
                                <td>{{ member.name }}</td>
                                <td>{{ member.email }}</td>
                                <td>
                                    <a href="/edit-member/{{ member.id }}" class="btn btn-secondary">Edit</a>
                                    <a href="/remove-member/{{ member.id }}" class="btn btn-primary">Remove</a>
                                </td>
                            </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </section>

        <!-- Manage Food Requests Section -->
        <section class="section manage-food-requests">
            <h3>Manage Food Deliveries</h3>
            <p>Review and manage requests for food items from food banks.</p>
            {% if requests %}
                <div class="food-requests">
                    <table class="table">
                        <thead>
                            <tr>
                                <th>Item Name</th>
                                <th>Food Bank Name</th>
                                <th>Quantity</th>
                                <th>Status</th>
                                <th>Food Bank Address</th>
                                <th>Distance</th>
                                <th>Action</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for request in requests %}
                                <tr>
                                    <td>{{ request.item_name }}</td>
                                    <td>{{ request.food_bank_name }}</td>
                                    <td>{{ request.quantity }}</td>
                                    <td>{{ request.status }}</td>
                                    <td>{{ request.food_bank_address }}</td>
                                    <td>{{ request.distance }}</td>
                                    {% if request.status == "Pending" %}
                                        <td>
                                            <a href="/manage-requests/accept/{{ request.id }}" class="btn btn-secondary">Accept</a>
                                            <a href="/manage-requests/decline/{{ request.id }}" class="btn btn-primary">Decline</a>
                                        </td>
                                    {% else %}
                                    <td>
                                        <a href="/manage-requests/confirm/{{ request.id }}" class="btn btn-secondary">Confirm Delivery</a>
                                        <a href="/chat/{{ request.id }}" class="btn">View Chat</a>
                                    </td>
                                    {% endif %}
                                </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            {% else %}
                <p>No food requests found.</p>
            {% endif %}
        </section>
    </div>
{% endblock %}